AUI.add("liferay-document-library",function(v){var z=v.Object;var i=v.Lang;var d=Liferay.HistoryManager;var o=v.UA.ie;var k="sync-message-hidden";var m=0;var g="displayStyleToolbar";var D="error";var C="searchRepositoryId";var u="searchType";var B=1;var E="click";var f="data-searchProcessed";var j="folderId";var r="keywords";var c="paginationData";var p="rowIdsDLFileShortcutCheckbox";var a="rowIdsFolderCheckbox";var s="rowIdsFileEntryCheckbox";var h="searchFolderId";var y="searchResultsContainer";var G="selectedFolder";var e="showRepositoryTabs";var t="showSearchInfo";var q="struts_action";var b=1;var F=2;var x=3;var n='<div class="alert alert-info">{0}</div><div class="loading-animation" />';var l=v.config.win;var w=v.Component.create({AUGMENTS:[Liferay.PortletBase,Liferay.DocumentLibraryUpload],EXTENDS:v.Base,NAME:"documentlibrary",prototype:{initializer:function(I){var R=this;var N=R.byId("documentLibraryContainer");R._documentLibraryContainer=N;R._eventDataProcessed=R.ns("dataProcessed");R._eventDataRequest=R.ns("dataRequest");R._eventDataRetrieveSuccess=R.ns("dataRetrieveSuccess");R._eventOpenDocument=R.ns("openDocument");R._eventChangeSearchFolder=R.ns("changeSearchFolder");R._entriesContainer=R.byId("entriesContainer");R._eventPageLoaded=R.ns("pageLoaded");R._keywordsNode=R.byId(r);if(!I.syncMessageDisabled){R._syncMessage=new Liferay.Message({boundingBox:R.byId("syncNotification"),contentBox:R.byId("syncNotificationContent"),id:R.NS+"show-sync-message",trigger:R.one("#showSyncMessageIconContainer"),visible:true}).render()}var V=[R.ns(p),R.ns(a),R.ns(s)];var S=I.displayStyle;var U="entry-display-style";var K=R.byId(g);var L=R.NS;var M=R.ns("documentLibraryContainer");var T=I.paginator;T.entryPaginationContainer=".document-entries-pagination";T.folderPaginationContainer=".folder-pagination";T.namespace=L;var Q=new Liferay.AppViewPaginator(T);R._appViewPaginator=Q;var P=I.select;P.checkBoxesId=V;P.displayStyle=S;P.displayStyleCSSClass=U;P.displayStyleToolbar=K;P.folderContainer=R.byId("folderContainer");P.namespace=L;P.portletContainerId=M;P.repositories=I.repositories;P.selector="entry-selector";R._appViewSelect=new Liferay.AppViewSelect(P);var O=I.move;O.processEntryIds={checkBoxesIds:V,entryIds:[R.ns("fileShortcutIds"),R.ns("folderIds"),R.ns("fileEntryIds")]};O.displayStyleCSSClass=U;O.draggableCSSClass=".entry-link";O.namespace=L;O.portletContainerId=M;O.portletGroup="document-library";R._appViewMove=new Liferay.AppViewMove(O);var J=I.folders;J.displayStyle=S;J.displayStyleCSSClass=U;J.displayStyleToolbar=K;J.namespace=L;J.portletContainerId=M;R._appViewFolders=new Liferay.AppViewFolders(J);var H=[Liferay.on(R._eventDataRetrieveSuccess,R._onDataRetrieveSuccess,R),Liferay.on(R._eventOpenDocument,R._openDocument,R),Liferay.on(R._eventPageLoaded,R._onPageLoaded,R),d.after("stateChange",R._afterStateChange,R),Liferay.on("showTab",R._onShowTab,R),Liferay.on(R._eventChangeSearchFolder,R._onChangeSearchFolder,R)];R._config=I;R._eventHandles=H;R._repositoriesData={};H.push(Liferay.on(I.portletId+":portletRefreshed",v.bind("destructor",R)));var A=R.one("#fm1");if(A){A.on("submit",R._onSearchFormSubmit,R)}R._toggleSyncNotification();R._toggleTrashAction()},destructor:function(){var A=this;v.Array.invoke(A._eventHandles,"detach");A._appViewFolders.destroy();A._appViewMove.destroy();A._appViewPaginator.destroy();A._appViewSelect.destroy();A._documentLibraryContainer.purge(true)},_afterStateChange:function(I){var A=this;var H=A.NS;var K={};var J=d.get();z.each(J,function(M,L,N){if(L.indexOf(H)===0){K[L]=M}});A._tuneStateChangeParams(K);if(z.isEmpty(K)){K=A._getDefaultHistoryState()}Liferay.fire(A._eventDataRequest,{requestParams:K,src:F})},_getDefaultHistoryState:function(){var H=this;var A=d.get();if(z.isEmpty(A)){A=H._appViewPaginator.get("defaultParams")}return A},_getRepositoryName:function(M){var A=this;var L=null;var I=A._config.repositories;var K=I.length;for(var H=0;H<K;H++){var J=I[H];if(J.id==M){L=J.name;break}}return L},_onChangeSearchFolder:function(J){var A=this;var I=A._appViewSelect.get(G);var H={folderId:I.id,keywords:A._keywordsNode.get("value"),repositoryId:I.repositoryId,showSearchInfo:true};if(J.searchEverywhere){H[C]=A._config.repositories[0].id;H[h]=A._config.folders.rootFolderId;H[e]=true}else{H[C]=I.repositoryId;H[h]=I.id;H[e]=false}A._searchFileEntry(H)},_onDataRetrieveSuccess:function(J){var A=this;var H=J.responseData;A._documentLibraryContainer.loadingmask.hide();var I=v.Node.create(H);if(I){A._setSearchResults(I);A._appViewFolders.processData(I);A._appViewSelect.syncDisplayStyleToolbar()}Liferay.fire(A._eventDataProcessed);l[A.ns("toggleActionsButton")]();if(J.data[A.ns("viewEntries")]){A._toggleTrashAction()}},_onPageLoaded:function(K){var A=this;var J=K.pagination;if(J){if(K.src==x){var I=A._repositoriesData;var H=I[K.repositoryId];if(!H){H={};A._repositoriesData[K.repositoryId]=H}H.paginationData=J}A._appViewPaginator.set(c,J);A._toggleSyncNotification()}},_onSearchFormSubmit:function(J){var A=this;J.preventDefault();var I=A._appViewSelect.get(G);var K=(I.id==m);var H={folderId:I.id,keywords:A._keywordsNode.get("value"),repositoryId:I.repositoryId,searchFolderId:A._folderId,searchRepositoryId:I.repositoryId,showRepositoryTabs:K,showSearchInfo:true};A._searchFileEntry(H)},_onShowTab:function(A){var N=this;if(A.namespace.indexOf(N.NS)===0){var L=A.tabSection;var M=L.one("[data-repositoryId]");var K=M.attr("data-repositoryId");var I=N._repositoriesData[K];if(I){var H=I.paginationData;if(H){N._appViewPaginator.set(c,H)}}if(!M.hasAttribute(f)){M.setAttribute(f,true);var O=N._appViewSelect.get(G);var J={folderId:O.id,keywords:N._keywordsNode.get("value"),repositoryId:O.repositoryId,searchFolderId:m,searchRepositoryId:K};N._searchFileEntry(J)}else{N._documentLibraryContainer.all(".document-entries-pagination").show()}}},_openDocument:function(H){var A=this;Liferay.Util.openDocument(H.webDavUrl,null,function(J){var I=i.sub('\u004e\u00e3\u006f\u0020\u00e9\u0020\u0070\u006f\u0073\u0073\u00ed\u0076\u0065\u006c\u0020\u0061\u0062\u0072\u0069\u0072\u0020\u006f\u0020\u0064\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u006f\u0020\u0073\u006f\u006c\u0069\u0063\u0069\u0074\u0061\u0064\u006f\u002c\u0020\u0064\u0065\u0076\u0069\u0064\u006f\u0020\u0061\u006f\u0020\u0073\u0065\u0067\u0075\u0069\u006e\u0074\u0065\u0020\u006d\u006f\u0074\u0069\u0076\u006f\u003a\u0020\u007b\u0030\u007d',[J.message]);A._appViewFolders.displayMessage(D,I)})},_searchFileEntry:function(H){var A=this;var J={};J[A.ns(q)]="/document_library/search";J[A.ns("repositoryId")]=H.repositoryId;J[A.ns(C)]=H.searchRepositoryId;J[A.ns(j)]=H.folderId;J[A.ns(h)]=H.searchFolderId;J[A.ns(r)]=H.keywords;J[A.ns(u)]=B;J[A.ns(e)]=H.showRepositoryTabs;J[A.ns(t)]=H.showSearchInfo;Liferay.fire(A._eventDataRequest,{requestParams:J,resetPagination:true,src:Liferay.DL_SEARCH});if(H.showRepositoryTabs||H.showSearchInfo){var K=A._entriesContainer;var I=i.sub(n,['\u0050\u0065\u0073\u0071\u0075\u0069\u0073\u0061\u006e\u0064\u006f\u002c\u0020\u0061\u0067\u0075\u0061\u0072\u0064\u0065\u0020\u0070\u006f\u0072\u0020\u0066\u0061\u0076\u006f\u0072\u002e']);K.html(I)}},_setSearchResults:function(O){var T=this;var N;var I=T.one("#"+T.ns(C),O);if(I){N=I.val()}var J=T.one("#"+T.ns("searchInfo"),O);var M=T._entriesContainer;if(J){M.empty();M.setContent(J)}var S=T.one("#fragmentSearchResults",O);var A;if(S){A=T.one("#"+y+N,M);if(A){A.empty();A.setContent(S.html())}}A=T.one(".local-search-results",O);if(A){var P=T.one("#"+y,O);if(!J){M.empty()}M.append(P)}var Q=T.one(".repository-search-results",O);if(Q){var L=T.one("#"+y+N,M);if(!L){L=M}if(!J){L.empty()}L.append(Q)}if(A||Q){T.all("#addButtonContainer, #sortButtonContainer").hide()}var R=T._getRepositoryName(N);if(R){var H='li[id$="'+Liferay.Util.toCharCode(R)+'TabsId"] a';var K=M.one(H);if(K){K.simulate(E)}}},_tuneStateChangeParams:function(I){var A=this;var K=A._entriesContainer;var H=A.ns(e);if(z.owns(I,H)&&!I[H]&&!K.one("ul.nav-tabs")){I[H]=true;I[A.ns(u)]=B}var J=A.ns(t);if(z.owns(I,J)&&!I[J]&&!K.one(".search-info")){I[J]=true;I[A.ns(u)]=B}},_toggleSyncNotification:function(){var A=this;if(A._syncMessage){var H=A._appViewPaginator.get("entryPagination");var I=A._syncMessage.get("boundingBox");I.toggleClass(k,H.get("total")<=0)}},_toggleTrashAction:function(){var A=this;var H=A._config.trashEnabled;if(H){var I=A._appViewSelect.get(G).repositoryId;var J=themeDisplay.getScopeGroupId();H=(J===I)}A.one("#deleteAction").toggle(!H);A.one("#moveToTrashAction").toggle(H)}}});Liferay.DL_ENTRIES_PAGINATOR=b;Liferay.DL_SEARCH=x;Liferay.Portlet.DocumentLibrary=w},"",{requires:["aui-loading-mask-deprecated","aui-parse-content","document-library-upload","event-simulate","liferay-app-view-folders","liferay-app-view-move","liferay-app-view-paginator","liferay-app-view-select","liferay-history-manager","liferay-message","liferay-portlet-base","querystring-parse-simple"]});